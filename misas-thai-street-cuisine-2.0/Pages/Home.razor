@page "/"

@using misas_thai_street_cuisine_2._0.Components
@using misas_thai_street_cuisine_2._0.Data

<div class="homepage-hero">
    <div class="hero-left">
        <h1 class="hero-title" tabindex="-1">@((MarkupString)heroTitle)</h1>
        <p class="hero-subtitle">@((MarkupString)heroSubtitle)</p>
        <button class="order-now-btn" @onclick="ScrollToMenuInfo">ORDER NOW</button>
        @* <button class="order-now-btn" @onclick="NavigateToCatering">REQUEST CATERING</button> *@
    </div>
    <div class="hero-right">
        <div class="carousel-container">
            <div id="heroCarousel" class="carousel slide carousel-fade">
                <div class="carousel-inner">
                    @for (int i = 0; i < CarouselImages.Count; i++)
                    {
                        <div class="carousel-item @(i == 0 ? "active" : "")">
                            <img src="@CarouselImages[i]" alt="Featured Thai Food" class="carousel-img"/>
                        </div>
                    }
                </div>
                <button class="carousel-control-prev" type="button" data-bs-target="#heroCarousel" data-bs-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Previous</span>
                </button>
                <button class="carousel-control-next" type="button" data-bs-target="#heroCarousel" data-bs-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Next</span>
                </button>
            </div>
        </div>
    </div>
</div>

<div class="how-it-works-section">
    <h2 class="how-it-works-title">How it Works</h2>
    <div class="how-it-works-steps">
        <div class="step">
            <div class="step-icon">
                <i class="fas fa-shopping-basket fa-4x"></i>
            </div>
            <h3 class="step-title">Place Your Order</h3>
            <p class="step-description">Select your dinner platter and order online by the cutoff date.</p>
        </div>
        <div class="step">
            <div class="step-icon">
                <i class="fas fa-fire-burner fa-4x"></i>
            </div>
            <h3 class="step-title">We Cook Fresh</h3>
            <p class="step-description">Our kitchen preps and cooks your meal from scratch on delivery day.</p>
        </div>
        <div class="step">
            <div class="step-icon">
                <i class="fas fa-house-chimney fa-4x"></i>
            </div>
            <h3 class="step-title">Delivered to Your Door</h3>
            <p class="step-description">Meals arrive hot in a corrugated box, family-style, with everything you need.</p>
        </div>
    </div>
</div>

<DeliveryArea />

<div id="menu-info">
    <MenuInfo />
</div>

@code {
    [Inject] private IJSRuntime JS { get; set; } = default!;
    [Inject] private NavigationManager Navigation { get; set; } = default!;

    private string heroTitle = string.Empty;
    private string heroSubtitle = string.Empty;

    private List<string> CarouselImages = new()
    {
        "/Resources/Images/HomepageCarousel/ms-platter.webp",
        "/Resources/Images/HomepageCarousel/ms-platter-2.webp",
        "/Resources/Images/HomepageCarousel/chicken-platter.webp",
        "/Resources/Images/HomepageCarousel/sausage-combo.webp"
    };

    protected override async Task OnInitializedAsync()
    {
        var (title, subtitle) = HeroContent.GetRandom();
        heroTitle = title;
        heroSubtitle = subtitle;

        foreach (var image in CarouselImages)
        {
            await JS.InvokeVoidAsync("preloadImage", image);
        }
    }

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            // Wait a bit to ensure Bootstrap is fully loaded
            await Task.Delay(500);
            // Initialize the carousel after the component has rendered
            await JS.InvokeVoidAsync("initializeCarousel", "heroCarousel");
        }
    }

    private async Task ScrollToMenuInfo()
    {
        await JS.InvokeVoidAsync("scrollToMenuInfo");
    }

    private void NavigateToCatering()
    {
        Navigation.NavigateTo("/catering");
    }
}

